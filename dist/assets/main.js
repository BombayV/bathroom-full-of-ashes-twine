const E={Start:()=>{},MainMenu:()=>{}},A=n=>{const{name:e}=n.passage;E[e]&&E[e]()},v={Start:()=>{},MainMenu:()=>{}},D=n=>{const{name:e}=n.passage;v[e]&&v[e]()};class c{static getSugarCubeObject(){return typeof window<"u"?window.SugarCube||window.SugarCubeAPI:null}static isAvailable(){const e=this.getSugarCubeObject();return e!=null&&e.Engine!==null}static goToPassage(e){const t=this.getSugarCubeObject();return this.isAvailable()&&t?.Engine?(t.Engine.play(e),!0):(console.warn("SugarCube Engine not available"),!1)}static getCurrentPassage(){const e=this.getSugarCubeObject();return this.isAvailable()&&e?.State?.active?e.State.active.title:null}static setVariable(e,t){const a=this.getSugarCubeObject();return this.isAvailable()&&a?.State?.variables?(a.State.variables[e]=t,!0):(console.warn("SugarCube State not available"),!1)}static getVariable(e,t){const a=this.getSugarCubeObject();return this.isAvailable()&&a?.State?.variables?a.State.variables[e]??t:t}static hasVisited(e){const t=this.getSugarCubeObject();return this.isAvailable()&&t?.State&&t.State.history?t.State.history.some(a=>a.title===e):!1}static getVisitCount(e){const t=this.getSugarCubeObject();return this.isAvailable()&&t?.State&&t.State.history?t.State.history.filter(a=>a.title===e).length:0}static goBack(){const e=this.getSugarCubeObject();return this.isAvailable()&&e?.Engine?(e.Engine.backward(),!0):(console.warn("SugarCube Engine not available"),!1)}static restart(){const e=this.getSugarCubeObject();return this.isAvailable()&&e?.Engine?(e.Engine.restart(),!0):(console.warn("SugarCube Engine not available"),!1)}static whenReady(e,t=5e3){if(this.isAvailable()){e();return}const a=()=>{document.removeEventListener("sugarcube-ready",a),e()};document.addEventListener("sugarcube-ready",a),setTimeout(()=>{document.removeEventListener("sugarcube-ready",a),this.isAvailable()||console.warn("SugarCube did not become available within timeout")},t)}static getStoryInfo(){const e=this.getSugarCubeObject();return this.isAvailable()&&e?.Story?{title:e.Story.title,id:e.Story.id}:null}static passageExists(e){const t=this.getSugarCubeObject();return this.isAvailable()&&t?.Story?t.Story.has(e):!1}static getSugarCube(){return this.getSugarCubeObject()}}const i=(n,e)=>{setTimeout(()=>{const t=document.getElementById(e);t&&(t.classList.remove("opacity-0"),setTimeout(()=>{t.classList.add("opacity-0"),setTimeout(()=>{c.whenReady(()=>{c.goToPassage(n)})},6e3)},8e3))},500)},g=(n,e,t=0)=>{const a=n[t];if(t>=n.length){console.error("Could not load image from any path");return}const s=new Image;s.onload=()=>{e.src=a,console.log("Image loaded successfully from:",a)},s.onerror=()=>{console.log("Failed to load from:",a),g(n,e,t+1)},s.src=a};window.testPath=g;const L=()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(n=>{console.error(`Error attempting to enable full-screen mode: ${n.message} (${n.name})`)})},M=()=>{setTimeout(()=>{const n=document.getElementById("background-image");n&&g(["assets/background.jpg","./assets/background.jpg","/assets/background.jpg"],n),document.getElementById("fullscreen-button")?.addEventListener("click",L)},0)},j=n=>{setTimeout(()=>{console.log("Starting loading animation");const e=document.getElementById("loading");e&&setTimeout(()=>{const t=e.querySelector("img"),a=e.querySelector("p");t&&t.classList.remove("opacity-0"),a&&a.classList.remove("opacity-0"),setTimeout(()=>{e&&(a&&a.classList.add("opacity-0"),t&&t.classList.add("opacity-0"),setTimeout(()=>{n&&n()},6e3))},6e3)},100)},100)},O=()=>{setTimeout(()=>{const n=document.getElementById("bathroom-image");n&&g(["assets/the_bathroom_full_of_ashes.png","./assets/the_bathroom_full_of_ashes.png","/assets/the_bathroom_full_of_ashes.png"],n),j(()=>{c.whenReady(()=>{c.goToPassage("MainMenu")})})},100)},C={Start:()=>{O()},MainMenu:()=>{M()},Day0:()=>{i("KitchenDay0","day-0")},Day0ChangeScene:()=>{i("HouseDay0-0","day-0-change")},Day0EnterHouse:()=>{i("InsideHouseDay0-0","day-0-enter")},Day0Dead:()=>{i("Day0DeadScreen","day-0-dead")},Day1:()=>{i("Day1Bathroom","day-1")},Day1Dead:()=>{i("Day1DeadScreen","day-1-dead")},Day2AloneFinger:()=>{i("Day2AloneFinger","day-2-alone-finger")},Day2BackupFinger:()=>{i("Day2BackupFinger","day-2-backup-finger")}},I=n=>{const{name:e}=n.passage;C[e]&&C[e]()},H=(n,e)=>{if(!n)return;const t=n.innerHTML,a=n.textContent||n.innerText||"";n.innerHTML="";const s=document.createElement("span");s.style.fontFamily="inherit",s.style.fontSize="inherit",s.style.lineHeight="inherit",s.style.color="inherit";const d=document.createElement("span");d.className="cursor",n.appendChild(s),n.appendChild(d);let m=0;const T=25,u=document.createElement("div");u.innerHTML=t,u.style.display="none",document.body.appendChild(u);const h=()=>{if(m<a.length){m++;const f=u.cloneNode(!0);let r=m;const S=o=>{if(r<=0)return!1;if(o.nodeType===Node.TEXT_NODE){const l=o.textContent||"";return r>=l.length?(r-=l.length,!0):(o.textContent=l.substring(0,r),r=0,!1)}else if(o.nodeType===Node.ELEMENT_NODE){const l=Array.from(o.childNodes);for(const p of l)if(!S(p)){const y=Array.from(o.childNodes),w=y.indexOf(p);for(let b=w+1;b<y.length;b++)o.removeChild(y[b]);break}return r>0}return!0};S(f),requestAnimationFrame(()=>{s.innerHTML=f.innerHTML}),setTimeout(h,T)}else requestAnimationFrame(()=>{s.innerHTML=t,d.style.animation="none"}),document.body.removeChild(u),e&&e()};h()};window.setupTypingAnimation=H;const _=()=>{c.whenReady(()=>{c.restart()})};window.restartGame=_;setTimeout(()=>{if(typeof window<"u"&&window.jQuery){const n=window.$;n(document).on(":passageend",D),n(document).on(":passageinit",A),n(document).on(":passagerender",I)}},0);
